# =====================================================
# Copyright 2025 Focason Co.,Ltd. AllRights Reserved.
# =====================================================

# -----------------------------------------------------
# 1. Spring Boot Configuration
# -----------------------------------------------------
server:
  port: ${SERVER_PORT:8888}                                           # Server port
  address: 0.0.0.0                                                    # Bind to all network interfaces

spring:
  application:
    name: ${APPLICATION_NAME:focason-config-server}                   # Application name

  security:
    user:
      name: ${CONFIGURE_SERVER_USERNAME:root}                         # Basic auth username for Config Server
      password: ${CONFIGURE_SERVER_PASSWORD:password}                 # Basic auth password

  rabbitmq:
    host: ${RABBITMQ_HOST:localhost}                                  # RabbitMQ host
    port: ${RABBITMQ_PORT:5672}                                       # RabbitMQ port
    username: ${RABBITMQ_USERNAME:guest}                              # RabbitMQ username
    password: ${RABBITMQ_PASSWORD:guest}                              # RabbitMQ password
    ssl:
      enabled: ${RABBITMQ_SSL:false}                                  # It must be enabled because Amazon MQ mandates SSL.

  cloud:
    bus:
      id: focason-config-bus                                          # Spring Cloud Bus ID
      enabled: true                                                   # Enable message bus
      refresh:
        enabled: true                                                 # Enable config refresh via Bus
      trace:
        enabled: true                                                 # Enable tracing for Bus events

    config:
      server:
        git:
          uri: ${GITHUB_PROJECT_HOST:https://github.com/yuanmz9432/focason-cloud-config}
          username: ${GITHUB_USERNAME}                                # Git username
          password: ${GITHUB_TOKEN}                                   # ⚠ MUST be environment variable, never hard-code
          default-label: ${GITHUB_BRANCH:main}                        # Git branch to read config from
          search-paths: ${GITHUB_ROOT_PATH}                           # Directory containing config files
          skip-ssl-validation: true                                   # Skip SSL validation
        bootstrap: true

# ----------------------------------------------------
# 2. Spring Cloud Service Discovery (Eureka) Configuration
# ----------------------------------------------------
eureka:
  instance:
    hostname: ${INSTANCE_HOSTNAME:localhost}                         # Gateway instance hostname
  client:
    service-url:
      defaultZone: http://${EUREKA_HOSTNAME:localhost}:8761/eureka/  # Eureka server URL for registration

# ----------------------------------------------------
# 3. Logging Configuration
# ----------------------------------------------------
logging:
  file:
    name: logs/focason-config-server.log                              # Log file path
  level:
    root: ${LOG_LEVEL:INFO}                                           # Root logging level

management:
  endpoints:
    web:
      exposure:
        include: bus-refresh, health # 为Actuator开放所需监控地址